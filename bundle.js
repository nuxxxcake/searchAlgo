!function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l=function(t,e){return e.x*t+e.y},d=function(t,e){for(var n=[],r=0,o=[[-1,0,"w"],[1,0,"e"],[0,-1,"s"],[0,1,"n"]];r<o.length;r++){var i=o[r],s={x:t.x+i[0],y:t.y+i[1],dir:i[2]};if(s.x<e&&s.y<e&&s.y>-1&&s.x>-1){var c=s.x,d=s.y;n.push(a(a({},s),{},{coordIndex:l(e,{x:c,y:d})}))}}return n},u=function(t,e){return t[e]&&t[e].cObstacle},f=function(e,n,r){var o=[n],i=new Map;i.set(n.coordIndex,"S");for(var a=function(){var t=o.shift();if(t.coordIndex===r.coordIndex)return{v:i};var n=t.coordIndex;t.neighbours.forEach((function(t){var r=t.coordIndex;u(e,r)||i.get(r)||(o.push(e[r]),i.set(r,n))}))};o.length;){var s=a();if("object"===t(s))return s.v}return!1},h=function(e,n,r){for(var o=new Map,i=[],a=[],s=0;s<e.length;s++)i[s]=1/0;var c=n.coordIndex;i[c]=0,o.set(c,"S");for(var l=function(){for(var t=1/0,n=-1,s=0;s<e.length;s++)i[s]<t&&!a[s]&&(t=i[s],n=s);a[n]=!0;var c=e[n];if(-1===n||c.coordIndex===r.coordIndex)return{v:o};var l=c.coordIndex;c.neighbours.forEach((function(t){var r=t.coordIndex;u(e,r)||(i[r]>i[n]&&(i[r]=i[n]+1),o.get(r)||o.set(r,l))}))};;){var d=l();if("object"===t(d))return d.v}},y=function(e,n,r){var o=new Map,i=[n],a=[],s=n.coordIndex;o.set(s,"S");for(var c=function(){for(var t=0,n=1;n<i.length;n++)i[n].f<i[t].f&&(t=n);var s=i[t];if(s.coordIndex===r.coordIndex)return{v:o};i.splice(t,1),a.push(s);var c=s.coordIndex,l=s.neighbours,d=s.g+1,f=!1;l.forEach((function(t){var n,s,l=e[t.coordIndex],h=l.coordIndex;a.find((function(t){return t.coordIndex===h}))||u(e,h)||(i.find((function(t){return t.coordIndex===h}))?d<l.g&&(f=!0):(f=!0,l.h=(n=l,s=r,Math.abs(n.x-s.x)+Math.abs(n.y-s.y)),i.push(e[h])),f&&(o.set(h,c),l.g=d,l.f=l.g+l.h))}))};i.length;){var l=c();if("object"===t(l))return l.v}},g=function t(e,n){var r=e.map((function(t){return a(a({},t),{},{cObstacle:!0,isInMaze:!1})})),o={n:[0,1,0,-1],s:[0,-1,0,1],e:[1,0,-1,0],w:[-1,0,1,0]},i=function(t){var e=o[t.dir];return[r[l(n,{x:t.x+e[0],y:t.y+e[1]})],r[l(n,{x:t.x+e[2],y:t.y+e[3]})]].filter((function(t){return t&&!t.isInMaze}))},s=Math.floor(Math.random()*r.length);r[s].cObstacle=!1,r[s].isInMaze=!0;var c,d=r[s=s%2==0?s+1:s],u=[];for(d.x&&(d.x-1>-1&&u.push(a(a({},r[l(n,a(a({},d),{},{x:d.x-1}))]),{},{dir:"w"})),d.x+1<n&&u.push(a(a({},r[l(n,a(a({},d),{},{x:d.x+1}))]),{},{dir:"e"}))),d.y&&(d.y-1>-1&&u.push(a(a({},r[l(n,a(a({},d),{},{y:d.y-1}))]),{},{dir:"s"})),d.y+1<n&&u.push(a(a({},r[l(n,a(a({},d),{},{y:d.y+1}))]),{},{dir:"n"})));u.length;){var f=(c=u,Math.floor(Math.random()*c.length)),h=u[f],y=i(h);if(y.length){var g=y[0],v=l(n,h),m=l(n,g);r[v].cObstacle=!1,r[m].cObstacle=!1,r[v].isInMaze=!0,r[m].isInMaze=!0,g.x-1>-1&&u.push(a(a({},r[l(n,a(a({},g),{},{x:g.x-1}))]),{},{dir:"w"})),g.y-1>-1&&u.push(a(a({},r[l(n,a(a({},g),{},{y:g.y-1}))]),{},{dir:"s"})),g.x+1<n&&u.push(a(a({},r[l(n,a(a({},g),{},{x:g.x+1}))]),{},{dir:"e"})),g.y+1<n&&u.push(a(a({},r[l(n,a(a({},g),{},{y:g.y+1}))]),{},{dir:"n"}))}u.splice(f,1)}if(r.filter((function(t){return t.cObstacle})).length<r.length/2)return t(e,n);for(var p=0;p<r.length;p++)delete r[p].isInMaze;return r},v=function(){function t(n){e(this,t),this.cells=n,this.animating=null}return r(t,[{key:"addToGrid",value:function(t,e,n){var r=document.createElement("div");r.setAttribute("coord",n),r.classList.add("cell");var o=t.children[n]?t.children[n]:t.appendChild(r);return a(a({},e),{},{elem:o})}},{key:"initialDraw",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=n.length?n:this.cells;this.setCells(r.map((function(n,r){return e.addToGrid(t,n,r)})))}},{key:"drawMaze",value:function(t,e){this.initialDraw(t,e);for(var n=0;n<this.cells.length;n++)this.cells[n].cObstacle&&this.drawWall(n)}},{key:"clearChecked",value:function(){this.cells.forEach((function(t){t.elem.classList.remove("checked","way","checked-anim","way-anim")}))}},{key:"destroy",value:function(){cancelAnimationFrame(this.animating),this.cells=null}},{key:"setCells",value:function(t){this.cells=t}},{key:"getCells",value:function(){return this.cells}},{key:"showAlgo",value:function(t,e,n){var r=this,o=function t(e,n,o){if(n===e.length)return o(),void cancelAnimationFrame(r.animating);var i=e[n];i&&r.cells[i]&&r.cells[i].elem.classList.add("checked-anim"),r.animating=requestAnimationFrame((function(){return t(e,n+1,o)}))};requestAnimationFrame((function(){return o(t,e,n)}))}},{key:"showAlgoNow",value:function(t){for(var e=0;e<t.length;e++){var n=t[e];this.cells[n].elem.classList.add("checked")}}},{key:"drawWayNow",value:function(t,e){for(var n=t.get(e);"S"!==e;)e=n,this.cells[n]&&this.cells[n].elem.classList.add("way"),n=t.get(e)}},{key:"drawWay",value:function(t,e,n,r){var o=this,i=function t(e,n,r,i){if("S"===r)return cancelAnimationFrame(o.animating),i(!0);var a=n.get(r);r=a,o.animating=requestAnimationFrame((function(){return t(e,n,a,i)})),e.children[a]&&e.children[a].classList.add("way-anim")};requestAnimationFrame((function(){return i(t,e,n,r)}))}},{key:"drawEnd",value:function(t,e){var n=this.cells[t];if(e&&(this.cells[e].cEnd=!1,this.cells[e].elem.classList.remove("end")),!n.cObstacle)return n.cEnd=!0,n.cObstacle=!1,n.cStart=!1,n.elem.classList.add("end"),{coordIndex:t,x:n.x,y:n.y}}},{key:"drawWall",value:function(t){var e=this.cells[t];e.cEnd=!1,e.cObstacle=!0,e.cStart=!1,e.elem.classList.add("block")}},{key:"drawStart",value:function(t,e){var n=this.cells[t];if(e&&(this.cells[e].cStart=!1,this.cells[e].elem.classList.remove("start")),!n.cObstacle)return n.cEnd=!1,n.cObstacle=!1,n.cStart=!0,n.elem.classList.add("start"),{coordIndex:t,x:n.x,y:n.y,g:0,h:0,f:0}}}]),t}(),m=function(){function t(n,r){e(this,t),this.max=n,this.coordFunc=r}return r(t,[{key:"generate",value:function(){for(var t=[],e=0;e<this.max;e++)for(var n=0;n<this.max;n++){var r;t[this.coordFunc({x:e,y:n})]=(o(r={x:e,y:n,coordIndex:l(this.max,{x:e,y:n}),g:0,h:0,f:0,cStart:!1,cChecked:!1,cEnd:!1,cObstacle:!1},"cChecked",!1),o(r,"neighbours",d({x:e,y:n},this.max)),r)}return t}},{key:"generateMaze",value:function(t){return g(t,this.max)}}]),t}(),p=function(){function t(n,r){e(this,t),this.grid=n,this.options=r,this.generateInstance=null,this.drawInstance=null,this.generate()}return r(t,[{key:"generate",value:function(){this.generateInstance=new m(this.options.cellNum,this.options.coord),this.drawInstance=new v(this.generateInstance.generate()),this.drawInstance.initialDraw(this.grid)}},{key:"resetGrid",value:function(){this.grid.innerHTML="",this.grid.classList.remove("no-click"),this.drawInstance.destroy(),this.options=a(a({},this.options),{Shift:!1,Ctrl:!1,started:!1,found:!1,dragged:!1,endCoord:null,startCoord:null}),this.generate()}},{key:"getOption",value:function(t){return this.options[t]}},{key:"setOption",value:function(t,e){this.options[t]=e}},{key:"updateGrid",value:function(t){var e=this.options,n=e.found;if(e.dragged&&(!n||!t.classList.contains("block"))){var r=+t.getAttribute("coord");this.options.Shift?(this.setOption("endCoord",this.drawInstance.drawEnd(r,this.options.endCoord&&this.options.endCoord.coordIndex)),n&&this.redrawAlgo()):this.options.Ctrl?this.drawInstance.drawWall(r):(this.setOption("startCoord",this.drawInstance.drawStart(r,this.options.startCoord&&this.options.startCoord.coordIndex)),n&&this.redrawAlgo())}}},{key:"startAlgo",value:function(){var t=this;if(!this.getOption("started")){var e=this.options,n=e.searchFunction,r=e.endCoord,o=e.startCoord;e.coord;if(r&&o){this.setOption("started",!0),this.grid.classList.add("no-click");var i=this.drawInstance.getCells(),a=n(i,i[o.coordIndex],i[r.coordIndex]),c=s(a.keys()),l=r.coordIndex;this.drawInstance.showAlgo(c,0,(function(){t.drawInstance.drawWay(t.grid,a,l,(function(e){t.setOption("found",e),e&&t.grid.classList.remove("no-click")}))}))}}}},{key:"generateMazeOnGrid",value:function(){var t=this.generateInstance.generateMaze(this.drawInstance.getCells());this.resetGrid(),this.drawInstance.drawMaze(this.grid,t)}},{key:"redrawAlgo",value:function(){var t=this.options,e=t.searchFunction,n=t.endCoord,r=t.startCoord,o=(t.coord,t.found);if(n&&r&&o){var i=this.drawInstance.getCells(),a=e(i,i[r.coordIndex],i[n.coordIndex]),c=s(a.keys()),l=n.coordIndex;this.drawInstance.clearChecked(),this.drawInstance.showAlgoNow(c),this.drawInstance.drawWayNow(a,l)}}}]),t}(),w=document.getElementById("grid"),x=document.documentElement.offsetWidth,b=(document.documentElement.offsetHeight,document.querySelector(".tabs"),document.getElementsByName("searchType")),I=document.getElementById("gridSize"),O=document.querySelector(".helper-buttons");I.setAttribute("max",(x/25).toFixed(0));var k=0,C=21,S=a({},{Shift:!1,Ctrl:!1,started:!1,found:!1,dragged:!1,endCoord:null,startCoord:null}),E=l.bind(null,C);w.style.width=20*C+"px";var A=new p(w,a(a({},S),{},{coord:E,cellNum:C}));I.onchange=function(t){C=+t.target.value,w.style.width=20*C+"px",A.setOption("cellNum",C),A.setOption("coord",l.bind(null,C)),A.resetGrid(),C>33?w.classList.add("grid_small"):w.classList.remove("grid_small")},start.onclick=function(){A.setOption("searchFunction",function(t){switch(t){case 0:return f;case 1:return h;case 2:return y}}(+k)),A.startAlgo()},maze.onclick=function(){return A.generateMazeOnGrid()},reset.onclick=function(){return A.resetGrid()},b.forEach((function(t){t.onclick=function(t){k=t.target.value,A.resetGrid()}})),w.onmouseup=function(t){A.updateGrid(t.target),A.setOption("dragged",!1)},w.onmousedown=function(t){A.setOption("dragged",!0)},w.onmousemove=function(t){A.getOption("dragged")&&A.updateGrid(t.target)},document.body.onkeydown=function(t){16===t.keyCode?(A.setOption("Shift",!0),O.lastElementChild.firstElementChild.classList.add("active")):17===t.keyCode&&(A.setOption("Ctrl",!0),O.firstElementChild.firstElementChild.classList.add("active"))},document.body.onkeyup=function(){for(var t=0;t<O.children.length;t++)O.children[t].firstElementChild.classList.remove("active");A.setOption("Ctrl",!1),A.setOption("Shift",!1)}}();
