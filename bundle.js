!function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l=function(t,e){return e.x*t+e.y},u=function(t,e){for(var n=[],r=0,i=[[-1,0,"w"],[1,0,"e"],[0,-1,"s"],[0,1,"n"]];r<i.length;r++){var o=i[r],a={x:t.x+o[0],y:t.y+o[1],dir:o[2]};a.x<e&&a.y<e&&a.y>-1&&a.x>-1&&n.push(a)}return n},d=function(t,e){return t[e]&&t[e].cObstacle},f=function(e,n,r,i){var o=[n],a=new Map;a.set(l(i,n),"S");for(var s=function(){var t=o.shift();if(t.x===r.x&&t.y===r.y)return{v:a};var n=l(i,t);u(t,i).forEach((function(t){if(!d(e,l(i,t))){var r=l(i,t);a.get(r)||(o.push(t),a.set(r,n))}}))};o.length;){var c=s();if("object"===t(c))return c.v}return!1},h=function(e,n,r,i){for(var o=new Map,a=[],s=[],c=0;c<e.length;c++)a[c]=1/0;var f=l(i,n);a[f]=0,o.set(f,"S");for(var h=function(){for(var t=1/0,n=-1,c=0;c<e.length;c++)a[c]<t&&!s[c]&&(t=a[c],n=c);s[n]=!0;var f=e[n];if(-1===n||f.x===r.x&&f.y===r.y)return{v:o};var h=l(i,f);u(f,i).forEach((function(t){if(!d(e,l(i,t))){var r=l(i,t);a[r]>a[n]&&(a[r]=a[n]+1),o.get(r)||o.set(r,h)}}))};;){var y=h();if("object"===t(y))return y.v}},y=function(e,n,r,i){var o=new Map,a=[n],s=[],c=l(i,n);o.set(c,"S");for(var f=function(){for(var t=0,n=1;n<a.length;n++)a[n].f<a[t].f&&(t=n);var c=a[t];if(c.x===r.x&&c.y===r.y)return{v:o};a.splice(t,1),s.push(c);var f=l(i,c),h=u(c,i),y=c.g+1,v=!1;h.forEach((function(t){var n,c;s.find((function(e){return l(i,e)===l(i,t)}))||d(e,l(i,t))||(a.find((function(e){return l(i,e)===l(i,t)}))?y<t.g&&(v=!0):(v=!0,t.h=(n=t,c=r,Math.abs(n.x-c.x)+Math.abs(n.y-c.y)),a.push(t)),v&&(o.set(l(i,t),f),t.g=y,t.f=t.g+t.h))}))};a.length;){var h=f();if("object"===t(h))return h.v}},v=function t(e,n){var r=e.map((function(t){return{x:t.x,y:t.y,cObstacle:!0,isInMaze:!1}})),i={n:[0,1,0,-1],s:[0,-1,0,1],e:[1,0,-1,0],w:[-1,0,1,0]},o=function(t){var e=i[t.dir];return[r[l(n,{x:t.x+e[0],y:t.y+e[1]})],r[l(n,{x:t.x+e[2],y:t.y+e[3]})]].filter((function(t){return t&&!t.isInMaze}))},s=Math.floor(Math.random()*r.length);r[s].cObstacle=!1,r[s].isInMaze=!0;var c,u=r[s=s%2==0?s+1:s],d=[];for(u.x&&(u.x-1>-1&&d.push(a(a({},r[l(n,a(a({},u),{},{x:u.x-1}))]),{},{dir:"w"})),u.x+1<n&&d.push(a(a({},r[l(n,a(a({},u),{},{x:u.x+1}))]),{},{dir:"e"}))),u.y&&(u.y-1>-1&&d.push(a(a({},r[l(n,a(a({},u),{},{y:u.y-1}))]),{},{dir:"s"})),u.y+1<n&&d.push(a(a({},r[l(n,a(a({},u),{},{y:u.y+1}))]),{},{dir:"n"})));d.length;){var f=(c=d,Math.floor(Math.random()*c.length)),h=d[f],y=o(h);if(y.length){var v=y[0],g=l(n,h),p=l(n,v);r[g].cObstacle=!1,r[p].cObstacle=!1,r[g].isInMaze=!0,r[p].isInMaze=!0,v.x-1>-1&&d.push(a(a({},r[l(n,a(a({},v),{},{x:v.x-1}))]),{},{dir:"w"})),v.y-1>-1&&d.push(a(a({},r[l(n,a(a({},v),{},{y:v.y-1}))]),{},{dir:"s"})),v.x+1<n&&d.push(a(a({},r[l(n,a(a({},v),{},{x:v.x+1}))]),{},{dir:"e"})),v.y+1<n&&d.push(a(a({},r[l(n,a(a({},v),{},{y:v.y+1}))]),{},{dir:"n"}))}d.splice(f,1)}return r.filter((function(t){return t.cObstacle})).length<r.length/2?t(e,n):r.map((function(t){return a(a({},t),{},{isInMaze:void 0})}))},g=function(){function t(n){e(this,t),this.cells=n,this.interval=null}return r(t,[{key:"addToGrid",value:function(t,e,n){var r=document.createElement("div");r.setAttribute("coord",n),r.classList.add("cell");var i=t.children[n]?t.children[n]:t.appendChild(r);return a(a({},e),{},{elem:i})}},{key:"initialDraw",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=n.length?n:this.cells;this.setCells(r.map((function(n,r){return e.addToGrid(t,n,r)})))}},{key:"drawMaze",value:function(t,e){this.initialDraw(t,e);for(var n=0;n<this.cells.length;n++)this.cells[n].cObstacle&&this.drawWall(n)}},{key:"clearChecked",value:function(){this.cells.forEach((function(t){t.elem.classList.remove("checked","way","checked-anim","way-anim")}))}},{key:"destroy",value:function(){clearTimeout(this.interval),this.cells=null}},{key:"setCells",value:function(t){this.cells=t}},{key:"getCells",value:function(){return this.cells}},{key:"showAlgo",value:function(t,e,n){var r=this;e!==t.length?this.interval=setTimeout((function(){var i=t[e];i&&r.cells[i]&&r.cells[i].elem.classList.add("checked-anim"),r.interval=setTimeout((function(){return r.showAlgo(t,e+1,n)}))})):n()}},{key:"showAlgoNow",value:function(t){for(var e=0;e<t.length;e++){var n=t[e];this.cells[n].elem.classList.add("checked")}}},{key:"drawWayNow",value:function(t,e){for(var n=t.get(e);"S"!==e;)e=n,this.cells[n]&&this.cells[n].elem.classList.add("way"),n=t.get(e)}},{key:"drawWay",value:function(t,e,n,r){var i=this;if("S"===n)return r(!0);this.interval=setTimeout((function(){var o=e.get(n);n=o,i.interval=setTimeout((function(){return i.drawWay(t,e,o,r)})),t.children[o]&&t.children[o].classList.add("way-anim")}))}},{key:"drawEnd",value:function(t,e){var n=this.cells[t];if(e&&(this.cells[e].cEnd=!1,this.cells[e].elem.classList.remove("end")),!n.cObstacle)return n.cEnd=!0,n.cObstacle=!1,n.cStart=!1,n.elem.classList.add("end"),{x:n.x,y:n.y}}},{key:"drawWall",value:function(t){var e=this.cells[t];e.cEnd=!1,e.cObstacle=!0,e.cStart=!1,e.elem.classList.add("block")}},{key:"drawStart",value:function(t,e){var n=this.cells[t];if(e&&(this.cells[e].cStart=!1,this.cells[e].elem.classList.remove("start")),!n.cObstacle)return n.cEnd=!1,n.cObstacle=!1,n.cStart=!0,n.elem.classList.add("start"),{x:n.x,y:n.y,g:0,h:0,f:0}}}]),t}(),p=function(){function t(n,r){e(this,t),this.max=n,this.coordFunc=r}return r(t,[{key:"generate",value:function(){for(var t=[],e=0;e<this.max;e++)for(var n=0;n<this.max;n++){t[this.coordFunc({x:e,y:n})]=i({x:e,y:n,g:0,h:0,f:0,cStart:!1,cChecked:!1,cEnd:!1,cObstacle:!1},"cChecked",!1)}return t}},{key:"generateMaze",value:function(t){return v(t,this.max)}}]),t}(),m=function(){function t(n,r){e(this,t),this.grid=n,this.options=r,this.generateInstance=null,this.drawInstance=null,this.generate()}return r(t,[{key:"generate",value:function(){this.generateInstance=new p(this.options.cellNum,this.options.coord),this.drawInstance=new g(this.generateInstance.generate()),this.drawInstance.initialDraw(this.grid)}},{key:"resetGrid",value:function(){this.grid.innerHTML="",this.grid.classList.remove("no-click"),this.drawInstance.destroy(),this.options=a(a({},this.options),{Shift:!1,Ctrl:!1,started:!1,found:!1,dragged:!1,endCoord:null,startCoord:null}),this.generate()}},{key:"getOption",value:function(t){return this.options[t]}},{key:"setOption",value:function(t,e){this.options[t]=e}},{key:"updateGrid",value:function(t){var e=this.options,n=e.found;if(e.dragged&&(!n||!t.classList.contains("block"))){var r=+t.getAttribute("coord");this.options.Shift?(this.setOption("endCoord",this.drawInstance.drawEnd(r,this.options.endCoord&&this.options.coord(this.options.endCoord))),n&&this.redrawAlgo()):this.options.Ctrl?this.drawInstance.drawWall(r):(this.setOption("startCoord",this.drawInstance.drawStart(r,this.options.startCoord&&this.options.coord(this.options.startCoord))),n&&this.redrawAlgo())}}},{key:"startAlgo",value:function(){var t=this;if(!this.getOption("started")){var e=this.options,n=e.searchFunction,r=e.endCoord,i=e.startCoord,o=e.cellNum,a=e.coord;if(r&&i){this.setOption("started",!0),this.grid.classList.add("no-click");var c=n(this.drawInstance.getCells(),i,r,o),l=s(c.keys()),u=a(r);this.drawInstance.showAlgo(l,0,(function(){t.drawInstance.drawWay(t.grid,c,u,(function(e){t.setOption("found",e),e&&t.grid.classList.remove("no-click")}))}))}}}},{key:"generateMazeOnGrid",value:function(){var t=this.generateInstance.generateMaze(this.drawInstance.getCells());this.resetGrid(),this.drawInstance.drawMaze(this.grid,t)}},{key:"redrawAlgo",value:function(){var t=this.options,e=t.searchFunction,n=t.endCoord,r=t.startCoord,i=t.cellNum,o=t.coord,a=t.found;if(n&&r&&a){var c=e(this.drawInstance.getCells(),r,n,i),l=s(c.keys()),u=o(n);this.drawInstance.clearChecked(),this.drawInstance.showAlgoNow(l),this.drawInstance.drawWayNow(c,u)}}}]),t}(),w=document.getElementById("grid"),b=document.documentElement.offsetWidth,O=(document.documentElement.offsetHeight,document.querySelector(".tabs"),document.getElementsByName("searchType")),k=document.getElementById("gridSize"),x=document.querySelector(".helper-buttons");k.setAttribute("max",(b/25).toFixed(0));var C=0,S=21,I=a({},{Shift:!1,Ctrl:!1,started:!1,found:!1,dragged:!1,endCoord:null,startCoord:null}),E=l.bind(null,S);w.style.width=20*S+"px";var M=new m(w,a(a({},I),{},{coord:E,cellNum:S}));k.onchange=function(t){S=+t.target.value,w.style.width=20*S+"px",M.setOption("cellNum",S),M.setOption("coord",l.bind(null,S)),M.resetGrid(),S>30?w.classList.add("grid_small"):w.classList.remove("grid_small")},start.onclick=function(){M.setOption("searchFunction",function(t){switch(t){case 0:return f;case 1:return h;case 2:return y}}(+C)),M.startAlgo()},maze.onclick=function(){return M.generateMazeOnGrid()},reset.onclick=function(){return M.resetGrid()},O.forEach((function(t){t.onclick=function(t){C=t.target.value,M.resetGrid()}})),w.onmouseup=function(t){M.updateGrid(t.target),M.setOption("dragged",!1)},w.onmousedown=function(t){M.setOption("dragged",!0)},w.onmousemove=function(t){M.getOption("dragged")&&M.updateGrid(t.target)},document.body.onkeydown=function(t){16===t.keyCode?(M.setOption("Shift",!0),x.lastElementChild.firstElementChild.classList.add("active")):17===t.keyCode&&(M.setOption("Ctrl",!0),x.firstElementChild.firstElementChild.classList.add("active"))},document.body.onkeyup=function(){for(var t=0;t<x.children.length;t++)x.children[t].firstElementChild.classList.remove("active");M.setOption("Ctrl",!1),M.setOption("Shift",!1)}}();
